{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2025-12-31T18:00:14.325814Z", "invocation_id": "408f1013-0947-42da-af60-9097ade91b33", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T18:00:13.117306Z", "completed_at": "2025-12-31T18:00:13.165175Z"}, {"name": "execute", "started_at": "2025-12-31T18:00:13.226071Z", "completed_at": "2025-12-31T18:00:13.537761Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.45404720306396484, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.analytics.stg_accounts", "compiled": true, "compiled_code": "with src as (\n\n    select * from \"warehouse\".\"raw\".\"accounts\"\n\n)\n\nselect\n    acct_id as account_id,\n    cust_id as customer_id,\n    case\n        when lower(type) in ('chk', 'checking') then 'CHECKING'\n        when lower(type) in ('sav', 'savings') then 'SAVINGS'\n        else 'UNKNOWN'\n    end as account_type,\n    case\n        when open_date ~ '^\\d{4}-\\d{2}-\\d{2}$'\n            then open_date::date\n        when open_date ~ '^\\d{2}-\\d{2}-\\d{4}$'\n            then to_date(open_date, 'MM-DD-YYYY')\n        when open_date ~ '^\\d{2}/\\d{2}/\\d{4}$'\n            then to_date(open_date, 'MM/DD/YYYY')\n        when open_date ~ '^\\d{4}/\\d{2}/\\d{2}$'\n            then to_date(open_date, 'YYYY/MM/DD')\n        when open_date ~ '^\\d{4}\\.\\d{2}\\.\\d{2}$'\n            then to_date(open_date, 'YYYY.MM.DD')\n        else null\n    end as opened_date,\n    case\n        when status_flag = '1' then 'ACTIVE'\n        else 'CLOSED'\n    end as account_status\nfrom src", "relation_name": "\"warehouse\".\"staging\".\"stg_accounts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T18:00:13.141403Z", "completed_at": "2025-12-31T18:00:13.169482Z"}, {"name": "execute", "started_at": "2025-12-31T18:00:13.270982Z", "completed_at": "2025-12-31T18:00:13.541576Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4511075019836426, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.analytics.stg_transactions", "compiled": true, "compiled_code": "with src as (\n\n    select * from \"warehouse\".\"raw\".\"transactions\"\n\n)\n\nselect\n    txn_id as transaction_id,\n    acct_id as account_id,\n    case\n        when txn_dt ~ '^\\d{4}-\\d{2}-\\d{2}$'\n            then txn_dt::date\n        when txn_dt ~ '^\\d{2}-\\d{2}-\\d{4}$'\n            then to_date(txn_dt, 'MM-DD-YYYY')\n        when txn_dt ~ '^\\d{2}/\\d{2}/\\d{4}$'\n            then to_date(txn_dt, 'MM/DD/YYYY')\n        when txn_dt ~ '^\\d{4}/\\d{2}/\\d{2}$'\n            then to_date(txn_dt, 'YYYY/MM/DD')\n        when txn_dt ~ '^\\d{4}\\.\\d{2}\\.\\d{2}$'\n            then to_date(txn_dt, 'YYYY.MM.DD')\n        else null\n    end as transaction_date,\n    case\n        when lower(txn_desc) like '%dep%' then 'DEPOSIT'\n        else 'WITHDRAWAL'\n    end as transaction_type,\n    case\n        when lower(txn_desc) like '%dep%' then abs(amt::numeric)\n        else -abs(amt::numeric)\n    end as amount\nfrom src", "relation_name": "\"warehouse\".\"staging\".\"stg_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T18:00:13.135216Z", "completed_at": "2025-12-31T18:00:13.162480Z"}, {"name": "execute", "started_at": "2025-12-31T18:00:13.172781Z", "completed_at": "2025-12-31T18:00:13.545730Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4572639465332031, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.analytics.stg_customers", "compiled": true, "compiled_code": "with src as (\n\n    select * from \"warehouse\".\"raw\".\"customers\"\n\n),\n\ndeduped as (\n\n    select distinct on (cust_id)\n        cust_id as customer_id,\n        split_part(full_name, ' ', 1) as first_name,\n        split_part(full_name, ' ', 2) as last_name,\n        case\n            when lower(province) in ('ontario', 'on') then 'ON'\n            when lower(province) in ('bc', 'british columbia') then 'BC'\n            when lower(province) = 'qc' then 'QC'\n            when lower(province) = 'ab' then 'AB'\n            else 'UNKNOWN'\n        end as province_code,\n        signup_dt\n    from src\n    order by cust_id, signup_dt\n\n)\n\nselect\n    customer_id,\n    first_name,\n    last_name,\n    province_code,\n    case\n        when signup_dt ~ '^\\d{4}-\\d{2}-\\d{2}$'\n            then signup_dt::date\n        when signup_dt ~ '^\\d{2}-\\d{2}-\\d{4}$'\n            then to_date(signup_dt, 'MM-DD-YYYY')\n        when signup_dt ~ '^\\d{2}/\\d{2}/\\d{4}$'\n            then to_date(signup_dt, 'MM/DD/YYYY')\n        when signup_dt ~ '^\\d{4}/\\d{2}/\\d{2}$'\n            then to_date(signup_dt, 'YYYY/MM/DD')\n        when signup_dt ~ '^\\d{4}\\.\\d{2}\\.\\d{2}$'\n            then to_date(signup_dt, 'YYYY.MM.DD')\n        else null\n    end as customer_since\nfrom deduped", "relation_name": "\"warehouse\".\"staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T18:00:13.613733Z", "completed_at": "2025-12-31T18:00:13.647962Z"}, {"name": "execute", "started_at": "2025-12-31T18:00:13.659708Z", "completed_at": "2025-12-31T18:00:13.981632Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.41329383850097656, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.analytics.dim_accounts", "compiled": true, "compiled_code": "select\n    a.account_id,\n    a.customer_id,\n    a.account_type,\n    a.opened_date,\n    a.account_status\nfrom \"warehouse\".\"staging\".\"stg_accounts\" a", "relation_name": "\"warehouse\".\"analytics\".\"dim_accounts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T18:00:13.620566Z", "completed_at": "2025-12-31T18:00:13.655308Z"}, {"name": "execute", "started_at": "2025-12-31T18:00:13.730600Z", "completed_at": "2025-12-31T18:00:13.987620Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4134066104888916, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.analytics.fct_transactions", "compiled": true, "compiled_code": "select\n    t.transaction_id,\n    t.account_id,\n    a.customer_id,\n    t.transaction_date,\n    t.transaction_type,\n    t.amount\nfrom \"warehouse\".\"staging\".\"stg_transactions\" t\nleft join \"warehouse\".\"staging\".\"stg_accounts\" a\n    on t.account_id = a.account_id", "relation_name": "\"warehouse\".\"analytics\".\"fct_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T18:00:13.629228Z", "completed_at": "2025-12-31T18:00:13.650353Z"}, {"name": "execute", "started_at": "2025-12-31T18:00:13.712177Z", "completed_at": "2025-12-31T18:00:13.993548Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4134998321533203, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.analytics.dim_customers", "compiled": true, "compiled_code": "select\n    customer_id,\n    first_name,\n    last_name,\n    province_code,\n    customer_since\nfrom \"warehouse\".\"staging\".\"stg_customers\"", "relation_name": "\"warehouse\".\"analytics\".\"dim_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T18:00:14.061910Z", "completed_at": "2025-12-31T18:00:14.101355Z"}, {"name": "execute", "started_at": "2025-12-31T18:00:14.106314Z", "completed_at": "2025-12-31T18:00:14.243385Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.19310331344604492, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.analytics.mart_customer_finance", "compiled": true, "compiled_code": "with transactions as (\n\n    select * from \"warehouse\".\"analytics\".\"fct_transactions\"\n\n),\n\naccounts as (\n\n    select * from \"warehouse\".\"analytics\".\"dim_accounts\"\n\n),\n\ncustomers as (\n\n    select * from \"warehouse\".\"analytics\".\"dim_customers\"\n\n),\n\nagg as (\n\n    select\n        customer_id,\n        count(*) as total_transactions,\n        sum(case when transaction_type = 'DEPOSIT' then amount else 0 end) as total_deposits,\n        sum(case when transaction_type = 'WITHDRAWAL' then abs(amount) else 0 end) as total_withdrawals,\n        sum(amount) as net_balance_change\n    from transactions\n    group by customer_id\n\n)\n\nselect\n    c.customer_id,\n    c.first_name,\n    c.last_name,\n    c.province_code,\n    c.customer_since,\n    coalesce(a.total_transactions, 0) as total_transactions,\n    coalesce(a.total_deposits, 0) as total_deposits,\n    coalesce(a.total_withdrawals, 0) as total_withdrawals,\n    coalesce(a.net_balance_change, 0) as net_balance_change\nfrom customers c\nleft join agg a\n    on c.customer_id = a.customer_id", "relation_name": "\"warehouse\".\"analytics\".\"mart_customer_finance\""}], "elapsed_time": 1.5215027332305908, "args": {"version_check": true, "cache_selected_only": false, "partial_parse": true, "print": true, "introspect": true, "log_level_file": "debug", "project_dir": "/dbt", "use_colors_file": true, "profiles_dir": "/dbt", "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "use_colors": true, "vars": {}, "log_level": "info", "printer_width": 80, "indirect_selection": "eager", "macro_debugging": false, "quiet": false, "write_json": true, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "defer": false, "invocation_command": "dbt run", "populate_cache": true, "select": [], "log_format": "default", "favor_state": false, "show_resource_report": false, "static_parser": true, "which": "run", "strict_mode": false, "exclude": [], "log_format_file": "debug", "log_path": "/dbt/logs"}}